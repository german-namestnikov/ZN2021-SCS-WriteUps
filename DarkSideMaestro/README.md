# DarkSideMaestro
## About  

Задание DarkSideMaestro - несколько не типичное, так как для решения необходимо минимальное знание OSINT приёмов или инструментов, связанных с поиском челоека по нику.

## Description

> Specialists of "Very ModernDevelopers Inc." discovered a backdoor in one of the latest versions of an industrial application. Examine the modified repository and find who did it. To complete this task, you don't need to hack this box. Use you open source intelligence skills.


## Solution

Задание начинется получения доступа к GoGs. Логин ```Alice```, пароль в контейнере Alice в папке Documents.
Внутри только один репозиторий **scada**
При внимательном изучении истории коммитов можно заметить, что большая часть коммитов была сделана почти полгода назад и лишь несколько отнсительно свежие
![commits_story](https://user-images.githubusercontent.com/83208042/131511887-03e42a79-49d3-49db-93b5-47296182dd7f.png)

Если проверить три последние коммита, то станет заметно, что два из них - просто переклеивание наклейки с опенсорса, а предпоследний - внесение реальных изменений в код.

![backdoor](https://user-images.githubusercontent.com/83208042/131513045-a0212d01-52d4-4d1b-8b12-b797eb499515.png)

Очевидно, что scada систма вряд ли должна при загрузке вывешивать неисзвестный сервис на нестадартном порту и принимать входящие соединения. Таким образом нами был обнаружен вредосный коммит от которого можно отталкиваться дальше. Здесь же был расположен первый флаг: `SCS_ZN2021{w31c0m3 m45732!}`.  

Смотрим на автора коммита - **d42k51d3m435720** Теперь мы знаем имя злодея, но что делать дальше? Так как задача подразумевает поиск в интернете, найти такую уникальную запись должно быть не сложно. Однако, так как страница не проиндексирована никаким из поисковиков, гугление по запросу `d42k51d3m435720` результатов не даст. Но, так как нам известно, что данная строчка, не что-то, а никнейм, у нас есть 2 варианта для поиска. 

* Соотнести, что задание связано с git и предположить что надо поискать на таких сайтах как *github*, *gitlab* или *bitbucket*
* Воспользоваться OSINT инструментами для поиска по никнейму в социальных сетях

Самый простой из подобных инструментов - [namechk](https://namechk.com/) и его аналоги. Например [namecheckup](https://namecheckup.com/)

![image](https://user-images.githubusercontent.com/83208042/131516243-8684fbe8-13e1-4fa2-8cdd-73e30e5f9193.png)
                                                         
Так же можно воспользоваться более тяжёлой артиллерией на локальной машине. Например [sherlock](https://github.com/sherlock-project/sherlock) или его форком [maigret](https://github.com/soxoj/maigret)

![image](https://user-images.githubusercontent.com/83208042/131518125-f910e67d-67b3-4675-8170-9abaf319c987.png)

Видим второй флаг (`SCS_ZN2021{1m_d4mn_c001}`), соответсвенно мы точно нашли логово злодея. У него только один репозиторий, в котором лежит недописанный скрипт для обохда по SSH.
По аналогии с первым заданием исследуем историю коммитов в поисках чего-нибудь интересного и достаточно быстро обнаруживаем, что из репозитория был удалён приватный ssh ключ. В конце ключа находится третий флаг (`SCS_ZN2021{d0n'7_f0291v3_d0n'7_f02937}`).

![image](https://user-images.githubusercontent.com/83208042/131520301-1f8667f0-33a7-40ec-a0b2-c20d7822333c.png)


Ключ должен дать доступ к следующему заданию, однако он зашифрован. Ещё чуть более внимательно изучаем исходники и находим passphrase '*s3cr3tphr4s3*'

![image](https://user-images.githubusercontent.com/83208042/131520501-0281cc10-f494-43b2-9fe9-d3c7fb98a6ca.png)

